// gcc -no-pie -fno-stack-protector -z relro -z now -s -o warmup warmup.c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

void setup()
{
    setbuf(stdin, 0);
    setbuf(stdout, 0);
    setbuf(stderr, 0);

    return;
}

__attribute__((used, noinline))
void win() {
    system("/bin/sh");
}

void vulnerable_function() {
    char buffer[64];
    printf("Enter your input: ");
    gets(buffer);  // Vulnerable function
}


void banner() {
printf("\n /$$   /$$  /$$$$$$  /$$$$$$$$ /$$$$$$$$       /$$$$$$$  /$$      /$$ /$$   /$$       /$$      /$$                                                      ");
printf("\n| $$  | $$ /$$__  $$|__  $$__/| $$_____/      | $$__  $$| $$  /$ | $$| $$$ | $$      | $$  /$ | $$                                                      ");
printf("\n| $$  | $$| $$  \\__/   | $$   | $$            | $$  \\ $$| $$ /$$$| $$| $$$$| $$      | $$ /$$$| $$  /$$$$$$   /$$$$$$  /$$$$$$/$$$$  /$$   /$$  /$$$$$$ ");
printf("\n| $$  | $$| $$         | $$   | $$$$$         | $$$$$$$/| $$/$$ $$ $$| $$ $$ $$      | $$/$$ $$ $$ |____  $$ /$$__  $$| $$_  $$_  $$| $$  | $$ /$$__  $$");
printf("\n| $$  | $$| $$         | $$   | $$__/         | $$____/ | $$$$_  $$$$| $$  $$$$      | $$$$_  $$$$  /$$$$$$$| $$  \\__/| $$ \\ $$ \\ $$| $$  | $$| $$  \\ $$");
printf("\n| $$  | $$| $$    $$   | $$   | $$            | $$      | $$$/ \\  $$$| $$\\  $$$      | $$$/ \\  $$$ /$$__  $$| $$      | $$ | $$ | $$| $$  | $$| $$  | $$");
printf("\n|  $$$$$$/|  $$$$$$/   | $$   | $$            | $$      | $$/   \\  $$| $$ \\  $$      | $$/   \\  $$|  $$$$$$$| $$      | $$ | $$ | $$|  $$$$$$/| $$$$$$$/");
printf("\n \\______/  \\______/    |__/   |__/            |__/      |__/     \\__/|__/  \\__/      |__/     \\__/ \\_______/|__/      |__/ |__/ |__/ \\______/ | $$____/ ");
printf("\n                                                                                                                                              | $$      ");
printf("\n                                                                                                                                              | $$      ");
printf("\n                                                                                                                                              |__/      ");
printf("\n");
}

int main() {
    setup();
    banner();
    vulnerable_function();
    return 0;
}

